# Secure Software Development Lifecycle (SSDLC) Template Configuration
# This file defines the configuration options and metadata requirements for the SSDLC template

# =============================================================================
# Required Metadata Fields
# =============================================================================
# These fields must be defined when instantiating a new document from this template

metadata:
  # Unique identifier for the document (e.g., SSDLC-PROJ-001)
  document-id:
    type: string
    required: true
    description: "Unique document identifier following project naming conventions"
    pattern: "^[A-Z]{3,6}-[A-Z0-9]+-[0-9]{3,5}$"
    example: "SSDLC-PROJ-001"

  # Name of the project this document belongs to
  project-name:
    type: string
    required: true
    description: "Official project name"
    example: "Secure Payment Processing System"

  # Primary author of the document
  author:
    type: string
    required: true
    description: "Primary author name or security team"
    example: "Security Engineering Team"

  # Security classification level
  classification:
    type: string
    required: true
    description: "Document security classification"
    allowed-values:
      - "Public"
      - "Internal"
      - "Confidential"
      - "Restricted"
      - "Secret"
      - "Top Secret"
    default: "Confidential"
    example: "Confidential"

  # Additional optional metadata
  distribution:
    type: string
    required: false
    description: "Distribution statement or restrictions"
    example: "Distribution limited to security cleared personnel only"

  contract-number:
    type: string
    required: false
    description: "Contract or purchase order number"
    example: "SEC-2023-001"

  organization:
    type: string
    required: false
    description: "Organization or company name"
    example: "SecureSoft Corporation"

  revision:
    type: string
    required: false
    description: "Document revision number"
    default: "1.0"
    pattern: "^[0-9]+\\.[0-9]+$"
    example: "1.0"

  # Security-specific metadata
  security-level:
    type: string
    required: false
    description: "Security assurance level or certification target"
    allowed-values:
      - "EAL1"
      - "EAL2"
      - "EAL3"
      - "EAL4"
      - "EAL5"
      - "EAL6"
      - "EAL7"
      - "Custom"
    example: "EAL4"

  compliance-frameworks:
    type: list
    required: false
    description: "Applicable security and compliance frameworks"
    examples:
      - "NIST SP 800-53"
      - "ISO 27001"
      - "OWASP SAMM"
      - "PCI DSS"
      - "GDPR"
      - "SOC 2"

# =============================================================================
# Build Options
# =============================================================================
# Configuration for document generation and compilation

build:
  # Output formats to generate
  output-formats:
    - format: pdf
      enabled: true
      description: "Generate PDF output using asciidoctor-pdf"
      
    - format: html
      enabled: true
      description: "Generate HTML output using asciidoctor"
      
    - format: docbook
      enabled: false
      description: "Generate DocBook XML output"

  # Theme configuration
  theme:
    # PDF theme file (relative to project root)
    pdf-theme: "themes/pdf/ecss-default-theme.yml"
    pdf-theme-alt: "themes/pdf/security-theme.yml"
    
    # HTML stylesheet (relative to project root)
    html-stylesheet: "themes/html/ecss-default.css"
    html-stylesheet-alt: "themes/html/security.css"
    
    # Allow theme customization per document
    customizable: true

  # Custom AsciiDoc attributes
  custom-attributes:
    # Document structure attributes
    doctype: book
    toc: left
    toclevels: 3
    sectnums: true
    sectnumlevels: 4
    
    # Visual attributes
    icons: font
    figure-caption: "Figure"
    table-caption: "Table"
    appendix-caption: "Appendix"
    chapter-label: ""
    xrefstyle: short
    
    # Source code highlighting
    source-highlighter: rouge
    
    # Experimental features
    experimental: true
    
    # Diagram support
    diagram-support: true
    diagram-cachedir: ".asciidoctor/diagram"
    diagram-svg-type: inline
    
    # Images directory
    imagesdir: "images"
    
    # Custom SSDLC-specific attributes
    document-type: "SSDLC"
    security-focus: true

  # Diagram rendering options
  diagrams:
    enabled: true
    formats:
      - plantuml
      - graphviz
      - mermaid
      - blockdiag
    java-required: true
    graphviz-required: true

  # Validation options
  validation:
    # Run syntax validation before build
    validate-syntax: true
    
    # Run structure validation
    validate-structure: true
    
    # Check for broken cross-references
    check-xrefs: true
    
    # Validate required sections exist
    required-sections:
      - "Revision History"
      - "Applicable Documents"
      - "Terms, Definitions and Abbreviations"
      - "Introduction"
      - "Security Requirements"
      - "Threat Model"
      - "Security Controls"
      - "Secure Development Practices"

    # Security-specific validation
    check-security-keywords: true
    required-security-sections:
      - "Threat Model"
      - "Risk Assessment"
      - "Access Control"
      - "Authentication and Authorization"
      - "Data Protection"
      - "Security Testing"

  # Build artifacts
  artifacts:
    # Output directory (relative to project root)
    output-dir: "build"
    
    # Log directory
    log-dir: "build/logs"
    
    # Keep intermediate files
    keep-artifacts: false
    
    # Redact sensitive information in logs
    redact-sensitive-data: true

# =============================================================================
# CI/CD Configuration
# =============================================================================
# Settings for continuous integration and deployment

ci-cd:
  # Artifact retention policy
  artifact-retention:
    # Number of days to retain build artifacts
    retention-days: 180
    
    # Retain artifacts from tagged releases indefinitely
    retain-releases: true
    
    # Maximum number of artifacts to keep
    max-artifacts: 100
    
    # Secure storage requirement
    encrypted-storage: true

  # Deployment targets
  deployment-targets:
    # Development environment
    - name: development
      enabled: true
      description: "Development document server"
      auto-deploy: false
      branches:
        - develop
        - feature/*
      url: "https://secure-docs-dev.example.com"
      security-scan: true
      
    # Staging environment
    - name: staging
      enabled: true
      description: "Staging document server for security review"
      auto-deploy: false
      branches:
        - main
        - release/*
      url: "https://secure-docs-staging.example.com"
      requires-approval: true
      security-scan: true
      
    # Production environment
    - name: production
      enabled: true
      description: "Production secure document repository"
      auto-deploy: false
      branches:
        - main
      tags:
        - v*
      url: "https://secure-docs.example.com"
      requires-approval: true
      approvers:
        - "security-officer"
        - "project-manager"
        - "ciso"
      security-scan: true
      access-control: strict

  # Build triggers
  triggers:
    # Build on push to these branches
    push-branches:
      - main
      - develop
      - release/*
      - hotfix/*
    
    # Build on pull requests to these branches
    pull-request-branches:
      - main
      - develop
    
    # Build on tag creation
    tags: true
    
    # Schedule periodic builds
    schedule:
      enabled: true
      cron: "0 3 * * 1"  # Weekly on Monday at 3 AM

  # Notification settings
  notifications:
    # Notify on build status
    on-success: true
    on-failure: true
    
    # Notification channels
    channels:
      - type: email
        enabled: true
        recipients:
          - "security-team@example.com"
          - "docs-team@example.com"
          
      - type: slack
        enabled: false
        webhook-url: "${SLACK_WEBHOOK_URL}"
        channel: "#security-docs"
        
      - type: teams
        enabled: false
        webhook-url: "${TEAMS_WEBHOOK_URL}"

  # Quality gates
  quality-gates:
    # Fail build if validation errors occur
    fail-on-validation-error: true
    
    # Fail build if warnings exceed threshold
    fail-on-warnings: true
    max-warnings: 5
    
    # Require all cross-references to be valid
    require-valid-xrefs: true
    
    # Security-specific gates
    require-security-review: true
    check-sensitive-data: true
    scan-for-vulnerabilities: true

  # Security scanning
  security-scanning:
    enabled: true
    
    # Scan for sensitive information in documents
    scan-types:
      - secrets
      - credentials
      - api-keys
      - private-keys
      - pii
    
    # Fail build if secrets detected
    fail-on-secrets: true
    
    # Tools to use
    tools:
      - gitleaks
      - truffleHog
      - detect-secrets

  # Pipeline stages
  pipeline:
    stages:
      - name: security-scan
        description: "Scan for sensitive information"
        commands:
          - "./scripts/scan-secrets.sh"
          
      - name: validate
        description: "Validate document syntax and structure"
        commands:
          - "bundle exec make verify"
          
      - name: build
        description: "Build document outputs"
        commands:
          - "bundle exec make all"
          
      - name: security-review
        description: "Security review checkpoint"
        enabled: true
        manual: true
        required-approvers: 1
          
      - name: package
        description: "Package artifacts securely"
        commands:
          - "tar -czf ssdlc-artifacts.tar.gz build/"
          - "gpg --encrypt ssdlc-artifacts.tar.gz"
          
      - name: deploy
        description: "Deploy to secure target environment"
        enabled: true
        manual: true
        requires-approval: true

# =============================================================================
# Template Metadata
# =============================================================================
# Information about this template

template:
  name: "SSDLC Template"
  version: "2.0"
  description: "Secure Software Development Lifecycle document template with security-first approach"
  
  maintainer:
    name: "Security Documentation Team"
    email: "security-docs@example.com"
  
  # Template file reference
  source-file: "ssdlc-template.adoc"
  
  # Required dependencies
  dependencies:
    asciidoctor: "~> 2.0"
    asciidoctor-pdf: "~> 2.3"
    asciidoctor-diagram: "~> 2.2"
    plantuml: "latest"
    graphviz: "latest"
    
  # Standards compliance
  standards:
    - "NIST SP 800-64"
    - "OWASP SAMM"
    - "ISO/IEC 27034"
    - "BSIMM"
    - "NIST SSDF"
  
  # Security certifications
  certifications:
    - "Common Criteria"
    - "FIPS 140-2"
    - "ISO 27001"
  
  last-updated: "2024-01-15"
